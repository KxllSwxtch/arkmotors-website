# .htaccess for React SPA on Apache (GoDaddy cPanel)
# ArkMotors Website - arkmotors.co.kr

# Enable Rewrite Engine for SPA routing
<IfModule mod_rewrite.c>
  RewriteEngine On

  # Set base directory (root domain deployment)
  RewriteBase /

  # Don't rewrite files or directories that actually exist
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d

  # Rewrite all other requests to index.html (SPA routing)
  RewriteRule ^ index.html [L]
</IfModule>

# CORS and Security Headers
<IfModule mod_headers.c>
  # CORS headers (matching Netlify configuration)
  Header set Access-Control-Allow-Origin "*"
  Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
  Header set Access-Control-Allow-Headers "Content-Type, Authorization"

  # Security headers
  Header set X-Content-Type-Options "nosniff"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set X-XSS-Protection "1; mode=block"
  Header set Referrer-Policy "strict-origin-when-cross-origin"

  # Cache control for static assets (aggressive caching)
  <FilesMatch "\.(jpg|jpeg|png|gif|webp|svg|ico|woff|woff2|ttf|eot|otf|css|js|json)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>

  # Don't cache HTML files (especially index.html for SPA updates)
  <FilesMatch "\.(html|htm)$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "0"
  </FilesMatch>
</IfModule>

# Enable compression for better performance
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE text/javascript
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/json
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>

# Prevent directory browsing
Options -Indexes

# Error document handling (redirect to SPA)
ErrorDocument 404 /index.html
ErrorDocument 403 /index.html

# PHP settings (if needed)
<IfModule mod_php.c>
  php_value upload_max_filesize 10M
  php_value post_max_size 10M
  php_value max_execution_time 300
  php_value max_input_time 300
</IfModule>
